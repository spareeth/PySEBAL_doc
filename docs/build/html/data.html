

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>PySEBAL data requirements &mdash; PySEBAL_doc 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PySEBAL data preparation and execution" href="run.html" />
    <link rel="prev" title="Linux in Windows 10" href="install_Lin_Win.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PySEBAL_doc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">PySEBAL Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_Lin_Win.html">Linux in Windows 10</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PySEBAL data requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#satellite-data">Satellite data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#acquiring-landsat-data">Acquiring Landsat data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bulk-download-landsat-data-using-command-line">Bulk download Landsat data using command line</a></li>
<li class="toctree-l3"><a class="reference internal" href="#naming-convention-of-landsat-data">Naming convention of Landsat data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#meteo-data">Meteo data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="run.html">PySEBAL data preparation and execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="gapfill.html">Aggregating to monthly and gapfilling</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PySEBAL_doc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>PySEBAL data requirements</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pysebal-data-requirements">
<h1>PySEBAL data requirements<a class="headerlink" href="#pysebal-data-requirements" title="Permalink to this headline">¶</a></h1>
<p>To run PySEBAL we need the following input data as shown below in the figure.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/data1.png"><img alt="_images/data1.png" src="_images/data1.png" style="width: 450px;" /></a>
<p class="caption"><span class="caption-text">List of input data required for PySEBAL</span></p>
</div>
<div class="section" id="satellite-data">
<h2>Satellite data<a class="headerlink" href="#satellite-data" title="Permalink to this headline">¶</a></h2>
<p>Currently PySEBAL support data from Landsat 4/5/7/8, MODIS, PROBA-V/VIIRS sensors/satellites.
In this documentation currently PySEBAL using Landsat data as input is explained. But data from other satellites can be easily used by replacing the Landsat data,</p>
<div class="section" id="acquiring-landsat-data">
<h3>Acquiring Landsat data<a class="headerlink" href="#acquiring-landsat-data" title="Permalink to this headline">¶</a></h3>
<p>The main archive of Landsat satellite (all missions – TM/ETM/OLI) is earth explorer website: <a class="reference external" href="https://earthexplorer.usgs.gov/">https://earthexplorer.usgs.gov/</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">First step is to create user login for this website so that you are able to download the data.</p>
</div>
<p>Let us now search and download data for Miandoab irrigation scheme in Iran for the time period April to September 2018.</p>
<div class="line-block">
<div class="line"><strong>Step1</strong></div>
</div>
<div class="line-block">
<div class="line">In the “Search Criteria” tab type in your “address/place” of your interest, in this case “Miandoab” and click “enter” or search for Path/row - 168/034.</div>
</div>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/ls1.png"><img alt="_images/ls1.png" src="_images/ls1.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Setting the search criteria</span></p>
</div>
<p>Click on the result (red box) and a location popup will appear over on the map.</p>
<div class="line-block">
<div class="line"><strong>Step2</strong></div>
</div>
<div class="line-block">
<div class="line">Now enter the date range for which data is required in the same tab.</div>
</div>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/ls2.png"><img alt="_images/ls2.png" src="_images/ls2.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Setting the date range</span></p>
</div>
<div class="line-block">
<div class="line"><strong>Step3</strong></div>
</div>
<div class="line-block">
<div class="line">Select the datasets you want to search and set the additional criteria of those data with cloud cover less than 20%</div>
</div>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/ls3.png"><img alt="_images/ls3.png" src="_images/ls3.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Setting additional criteria and listing results</span></p>
</div>
<p>Here we are selecting only Landsat 8 data. For previous years you can also try with Landsat 7 ETM, and Landsat 4/5 TM. Finally click the “Results” to see list of all available data with our conditions met for the study area in the given period of time.</p>
<div class="line-block">
<div class="line"><strong>Step4</strong></div>
</div>
<div class="line-block">
<div class="line">Check the listed scenes using browse images, select and download the 168/034 scene</div>
</div>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="_images/ls4.png"><img alt="_images/ls4.png" src="_images/ls4.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">List of available landsat 8 data for the given period of time</span></p>
</div>
<p>The image icon under each result can be used to see the preview of that landsat scene (see Figure above). The download icon can be used to download that single scene with out ordering. While the Bulk download icon can be used to get a single link to download multiple products at a time. More details on bulk download can be found here - <a class="reference external" href="https://www.usgs.gov/media/videos/eros-earthexplorer-how-do-a-bulk-download">https://www.usgs.gov/media/videos/eros-earthexplorer-how-do-a-bulk-download</a>.</p>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="_images/ls6.png"><img alt="_images/ls6.png" src="_images/ls6.png" style="width: 350px;" /></a>
<p class="caption"><span class="caption-text">Showing the preview image of a landsat scene</span></p>
</div>
<p>For example, image dated 22 June 2018 looks really good, click on the download icon to get the data. You have to login in order to download the data.</p>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="_images/ls5.png"><img alt="_images/ls5.png" src="_images/ls5.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Landsat download options, select the one highlighted</span></p>
</div>
<p>From the list of options download the “Level-1 GeoTIFF Data Product” to get all the spectral bands and metadata of the scene.</p>
</div>
<div class="section" id="bulk-download-landsat-data-using-command-line">
<h3>Bulk download Landsat data using command line<a class="headerlink" href="#bulk-download-landsat-data-using-command-line" title="Permalink to this headline">¶</a></h3>
<p>This section explains how you can download big amount of Landsat data from Google cloud bucket using command line.</p>
<div class="line-block">
<div class="line"><strong>Steps</strong></div>
</div>
<ul class="simple">
<li>Install gsutil library - <a class="reference external" href="https://pypi.org/project/gsutil/">https://pypi.org/project/gsutil/</a></li>
<li>If you want to list all the Landsat 8 data over Miandoab covering tile 168/034 in June 2018 use the following command:</li>
</ul>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>gsutil ls -d gs://gcp-public-data-landsat/LC08/01/168/034/LC08_L1TP_168034_201806*T1
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>To download them, use the following command:</li>
</ul>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># &#39;.&#39; means it will download to present directory</span>
gsutil -m cp -r gs://gcp-public-data-landsat/LC08/01/168/034/LC08_L1TP_168034_201806*T1 .
</pre></div>
</td></tr></table></div>
<p>This <a class="reference external" href="https://shuzhanfan.github.io/2018/05/download-landsat8-data-from-google-cloud/">link</a> has more details on this approach.</p>
</div>
<div class="section" id="naming-convention-of-landsat-data">
<h3>Naming convention of Landsat data<a class="headerlink" href="#naming-convention-of-landsat-data" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="_images/ls7.png"><img alt="_images/ls7.png" src="_images/ls7.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Landsat data naming convention</span></p>
</div>
</div>
</div>
<div class="section" id="meteo-data">
<h2>Meteo data<a class="headerlink" href="#meteo-data" title="Permalink to this headline">¶</a></h2>
<p>Meteo data is either obtained from field stations or from global models like GLDAS, ERA5, MERRA2 etc.
Here we will use instantaneous and daily average computed from GLDAS data. You can download 3 hourly GLDAS data from this web link: <a class="reference external" href="https://hydro1.gesdisc.eosdis.nasa.gov/data/GLDAS/GLDAS_NOAH025_3H.2.1/">https://hydro1.gesdisc.eosdis.nasa.gov/data/GLDAS/GLDAS_NOAH025_3H.2.1/</a></p>
<div class="line-block">
<div class="line">Once downloaded the data, we use GDAL and GRASS GIS to compute the required meteo parameters for PySEBAL.</div>
</div>
<div class="line-block">
<div class="line">The GLDAS data is provided in netCDF4 format with number of measured parameters as subdatasets. Let us assume that you have downloaded the GLDAS data for the 6 June 2018 00:00 hours.</div>
</div>
<div class="line-block">
<div class="line">The file name will be <code class="docutils literal notranslate"><span class="pre">GLDAS_NOAH025_3H.A20180606.0000.021.nc4</span></code>.</div>
</div>
<p>Now let us do all the processing in GDAL library and GRASS GIS already installed in your system.</p>
<div class="line-block">
<div class="line">Open <strong>OSGeo4W Shell</strong></div>
<div class="line">Type <code class="docutils literal notranslate"><span class="pre">grass78</span> <span class="pre">--gui</span></code> and enter</div>
<div class="line">It will open the following interface</div>
</div>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="_images/grass1.png"><img alt="_images/grass1.png" src="_images/grass1.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">GRASS GIS start window, set DB, Location and Mapset here.</span></p>
</div>
<div class="line-block">
<div class="line">For an introduction to GRASS GIS see this <a class="reference external" href="https://gitpitch.com/veroandreo/grass_opengeohub2019/master?p=slides/intro">presentation</a>.</div>
</div>
<p>Before we proceed with GRASS GIS we will set the linux environment in the OSGeo4W Shell. Please download this <a class="reference external" href="https://github.com/spareeth/PySEBAL_doc/blob/version3.7.3/.bashrc">file</a> and save in <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">$HOME</span></code> folder. Please change line no: 22 in this file <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> only the <code class="docutils literal notranslate"><span class="pre">/c/OSGeo4W64/apps/grass/grass78/scripts</span></code> to the corresponding path in your computer.</p>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Start the Linux bash</span>
 bash
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the export path above, adapt your path accordingly. If your OSGeo4W installation is elsewhere, make changes accordingly.</p>
</div>
<p>Now in the command line type in following commands to extract required variables from GLDAS</p>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># To see the metadata run the following command</span>
 gdalinfo GLDAS_NOAH025_3H.A20180606.0000.021.nc4
 <span class="c1"># To import specific humidity</span>
 gdal_translate NETCDF:<span class="s2">&quot;GLDAS_NOAH025_3H.A20180606.0000.021.nc4&quot;</span>:Qair_f_inst GLDAS_NOAH025_3H_20180606_0000_Qair.tif
 <span class="c1"># To import Pressure in Pa</span>
 gdal_translate NETCDF:<span class="s2">&quot;GLDAS_NOAH025_3H.A20180606.0000.021.nc4&quot;</span>:Psurf_f_inst GLDAS_NOAH025_3H_20180606_0000_Psurf.tif
 <span class="c1"># To import air temperature</span>
 gdal_translate NETCDF:<span class="s2">&quot;GLDAS_NOAH025_3H.A20180606.0000.021.nc4&quot;</span>:Tair_f_inst GLDAS_NOAH025_3H_20180606_0000_Tair.tif
 <span class="c1"># To import Wind speed</span>
 gdal_translate NETCDF:<span class="s2">&quot;GLDAS_NOAH025_3H.A20180606.0000.021.nc4&quot;</span>:Wind_f_inst GLDAS_NOAH025_3H_20180606_0000_Wind.tif
 <span class="c1"># To import Short wave downward radiation</span>
 gdal_translate NETCDF:<span class="s2">&quot;GLDAS_NOAH025_3H.A20180606.0000.021.nc4&quot;</span>:SWdown_f_tavg GLDAS_NOAH025_3H_20180606_0000_SWdown.tif
</pre></div>
</td></tr></table></div>
<p>** How to do the above set of commands using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop **</p>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># To convert the Wind speed parameter for a day every three hours data, means 8 tif files for wind speed a day</span>
 <span class="k">for</span> i <span class="k">in</span> <span class="s2">&quot;00&quot;</span> <span class="s2">&quot;03&quot;</span> <span class="s2">&quot;06&quot;</span> <span class="s2">&quot;09&quot;</span> <span class="s2">&quot;12&quot;</span> <span class="s2">&quot;15&quot;</span> <span class="s2">&quot;18&quot;</span> <span class="s2">&quot;21&quot;</span><span class="p">;</span> <span class="k">do</span>
     gdal_translate NETCDF:<span class="s2">&quot;GLDAS_NOAH025_3H.A20180606.</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">00.021.nc4&quot;</span>:Qair_f_inst GLDAS_NOAH025_3H_20180606_<span class="si">${</span><span class="nv">i</span><span class="si">}</span>00_Qair.tif
 <span class="k">done</span>
 <span class="c1"># Now repeat it for all the 6 parameters required for PySEBAL for both dates - 06 June 2019 and 22 June 2019</span>
</pre></div>
</td></tr></table></div>
<div class="line-block">
<div class="line">Now we have to import these <code class="docutils literal notranslate"><span class="pre">tif</span></code> files into GRASS GIS</div>
<div class="line">Following commands will import the files into GRASS GIS</div>
</div>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># To import all the above tif files</span>
 r.import.py <span class="k">in</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_Qair.tif <span class="nv">out</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_Qair -o --o
 r.import.py <span class="k">in</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_Psurf.tif <span class="nv">out</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_Psurf -o --o
 r.import.py <span class="k">in</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_Tair.tif <span class="nv">out</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_Tair -o --o
 r.import.py <span class="k">in</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_Wind.tif <span class="nv">out</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_Wind -o --o
 r.import.py <span class="k">in</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_SWdown.tif <span class="nv">out</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_0000_SWdown -o --o
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Try to do the above commands and the following commands using <code class="docutils literal notranslate"><span class="pre">for</span></code> loop</p>
</div>
<p>Let us set the Computational region in GRASS GIS so that rest of all the analysis compute only in our study area</p>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># To set the computational region</span>
 g.region <span class="nv">res</span><span class="o">=</span><span class="m">0</span>.25 -a
 g.region -p
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Always start your GRASS GIS work with checking the <code class="docutils literal notranslate"><span class="pre">g.region</span> <span class="pre">-p</span></code> to make sure about the computational region and resolution.</p>
</div>
<div class="line-block">
<div class="line">Now we have to do three major Steps</div>
</div>
<ul class="simple">
<li>Convert airtemperature in kelvin to Deg C.</li>
<li>Convert Pressure in Pa to Milli bar (Mb)</li>
<li>Convert Specific humidity to relative humidity following the description <a class="reference external" href="https://earthscience.stackexchange.com/questions/2360/how-do-i-convert-specific-humidity-to-relative-humidity/">here</a></li>
</ul>
<div class="line-block">
<div class="line">Run the following commands to do the conversions:</div>
</div>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1">## Air temperature</span>
 r.mapcalc <span class="s2">&quot;GLDAS_NOAH025_3H_20180606_0000_Tair_deg = GLDAS_NOAH025_3H_20180606_0000_Tair - 273.15&quot;</span> --o
     <span class="c1">## Pressure convert from pa to mb</span>
 r.mapcalc <span class="s2">&quot;GLDAS_NOAH025_3H_20180606_0000_Psurf_mb = GLDAS_NOAH025_3H_20180606_0000_Psurf / 100&quot;</span> --o
     <span class="c1">## Humidity according to the url: https://earthscience.stackexchange.com/questions/2360/how-do-i-convert-specific-humidity-to-relative-humidity</span>
 <span class="c1"># Saturation vapour pressure</span>
 r.mapcalc <span class="s2">&quot;es = 6.112 * exp((17.67 * GLDAS_NOAH025_3H_20180606_0000_Tair_deg) / (GLDAS_NOAH025_3H_20180606_0000_Tair_deg + 243.5))&quot;</span> --o
 <span class="c1"># vapour pressure</span>
 r.mapcalc <span class="s2">&quot;e = (GLDAS_NOAH025_3H_20180606_0000_Qair * GLDAS_NOAH025_3H_20180606_0000_Psurf_mb) / (0.378 * GLDAS_NOAH025_3H_20180606_0000_Qair + 0.622)&quot;</span> --o
 <span class="c1"># Calculate Relative humidity</span>
 r.mapcalc <span class="s2">&quot;GLDAS_NOAH025_3H_20180606_0000_Rh1 = (e / es) * 100&quot;</span> --o
 <span class="c1"># Remove outliers</span>
 r.mapcalc <span class="s2">&quot;GLDAS_NOAH025_3H_20180606_0000_Rh = float(if(GLDAS_NOAH025_3H_20180606_0000_Rh1 &gt; 100, 100, if(GLDAS_NOAH025_3H_20180606_0000_Rh1 &lt; 0, 0, GLDAS_NOAH025_3H_20180606_0000_Rh1)))&quot;</span> --o
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">How to do above set of commands in a single run using <code class="docutils literal notranslate"><span class="pre">for</span></code> loop ??</p>
</div>
<p>Repeat the above steps for other NC files as well, GLDAS_NOAH025_3H.A20180606.0300.021.nc4, GLDAS_NOAH025_3H.A20180606.0600.021.nc4, GLDAS_NOAH025_3H.A20180606.0900.021.nc4, GLDAS_NOAH025_3H.A20180606.1200.021.nc4, GLDAS_NOAH025_3H.A20180606.1500.021.nc4, GLDAS_NOAH025_3H.A20180606.1800.021.nc4, GLDAS_NOAH025_3H.A20180606.2100.021.nc4</p>
<div class="line-block">
<div class="line">Using single commands <strong>OR</strong> combine jobs using <code class="docutils literal notranslate"><span class="pre">for</span></code> loop</div>
</div>
<div class="line-block">
<div class="line">Now let us create instantaneous and daily averages:</div>
<div class="line">For the data in 20180606 follow the commands below in GRASS GIS, For instantaneous we are going to take the data at 0900 hour as Landsat acquisition time is around 8:30 (Both Landsat and GLDAS times are in GMT). The time varies according to your study area.</div>
</div>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1">## Air temperature instantaneous</span>
 r.mapcalc <span class="s2">&quot;GLDAS_NOAH025_3H_20180606_Tair_inst = GLDAS_NOAH025_3H_20180606_0900_Tair_deg&quot;</span>
 <span class="c1">## Shortwave radiation instantaneous</span>
 r.mapcalc <span class="s2">&quot;GLDAS_NOAH025_3H_20180606_SWdown_inst = GLDAS_NOAH025_3H_20180606_0900_SWdown&quot;</span>
 <span class="c1">## Wind speed instantaneous</span>
 r.mapcalc <span class="s2">&quot;GLDAS_NOAH025_3H_20180606_Wind_inst = GLDAS_NOAH025_3H_20180606_0900_Wind&quot;</span>
 <span class="c1">## Relative humidity instantaneous</span>
 r.mapcalc <span class="s2">&quot;GLDAS_NOAH025_3H_20180606_Rh_inst = GLDAS_NOAH025_3H_20180606_0900_Rh&quot;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">How to do above set of commands in a single run using <code class="docutils literal notranslate"><span class="pre">for</span></code> loop ??</p>
</div>
<div class="line-block">
<div class="line">Next calculate the daily averages</div>
</div>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1">## Air temperature daily average</span>
 <span class="nv">MAPS1</span><span class="o">=</span><span class="sb">`</span>g.list rast <span class="nv">pattern</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_*_Tair_deg$ <span class="nv">sep</span><span class="o">=</span>, <span class="nv">map</span><span class="o">=</span>.<span class="p">|</span>cat<span class="sb">`</span>
 r.series <span class="nv">input</span><span class="o">=</span><span class="si">${</span><span class="nv">MAPS1</span><span class="si">}</span> <span class="nv">output</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_Tair_24 <span class="nv">method</span><span class="o">=</span>average
 <span class="c1">## Short wave radiation daily average</span>
 <span class="nv">MAPS2</span><span class="o">=</span><span class="sb">`</span>g.list rast <span class="nv">pattern</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_*_SWdown$ <span class="nv">sep</span><span class="o">=</span>, <span class="nv">map</span><span class="o">=</span>.<span class="p">|</span>cat<span class="sb">`</span>
 r.series <span class="nv">input</span><span class="o">=</span><span class="si">${</span><span class="nv">MAPS2</span><span class="si">}</span> <span class="nv">output</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_SWdown_24 <span class="nv">method</span><span class="o">=</span>average
 <span class="c1">## Wind daily average</span>
 <span class="nv">MAPS3</span><span class="o">=</span><span class="sb">`</span>g.list rast <span class="nv">pattern</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_*_Wind$ <span class="nv">sep</span><span class="o">=</span>, <span class="nv">map</span><span class="o">=</span>.<span class="p">|</span>cat<span class="sb">`</span>
 r.series <span class="nv">input</span><span class="o">=</span><span class="si">${</span><span class="nv">MAPS3</span><span class="si">}</span> <span class="nv">output</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_Wind_24 <span class="nv">method</span><span class="o">=</span>average
 <span class="c1">## Relative humidity daily average</span>
 <span class="nv">MAPS4</span><span class="o">=</span><span class="sb">`</span>g.list rast <span class="nv">pattern</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_*_Rh$ <span class="nv">sep</span><span class="o">=</span>, <span class="nv">map</span><span class="o">=</span>.<span class="p">|</span>cat<span class="sb">`</span>
 r.series <span class="nv">input</span><span class="o">=</span><span class="si">${</span><span class="nv">MAPS4</span><span class="si">}</span> <span class="nv">output</span><span class="o">=</span>GLDAS_NOAH025_3H_20180606_Rh_24 <span class="nv">method</span><span class="o">=</span>average
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">How to do above set of commands in a single run using <code class="docutils literal notranslate"><span class="pre">for</span></code> loop ??</p>
</div>
<p>Now let us <strong>resample</strong> the instantaneous and daily averaged to avoid pixel effects and <strong>export</strong> the prepared raster maps to tif files for PySEBAL to read and process Landsat data.</p>
<div class="highlight-Shell notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1">## Set the region with require resolution</span>
 g.region <span class="nv">vect</span><span class="o">=</span>study_area_big <span class="nv">res</span><span class="o">=</span><span class="m">0</span>.0625 -a
 <span class="c1">## change directory to output folder</span>
 <span class="nb">cd</span> /to/the/folder/you/want/to/store/meteo/data
 <span class="c1">## For loop to resample all the instantaneous maps</span>
 <span class="k">for</span> i <span class="k">in</span> <span class="sb">`</span>g.list rast <span class="nv">pattern</span><span class="o">=</span>*inst$ <span class="nv">map</span><span class="o">=</span>.<span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
     r.resamp.bspline <span class="k">in</span><span class="o">=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span> <span class="nv">out</span><span class="o">=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_interp <span class="nv">method</span><span class="o">=</span>bicubic --o
     r.out.gdal <span class="k">in</span><span class="o">=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_interp <span class="nv">out</span><span class="o">=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_interp.tif --o
 <span class="k">done</span>
 <span class="c1">## For loop to resample all the daily averages maps</span>
 <span class="k">for</span> i <span class="k">in</span> <span class="sb">`</span>g.list rast <span class="nv">pattern</span><span class="o">=</span>*24$ <span class="nv">map</span><span class="o">=</span>.<span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
     r.resamp.bspline <span class="k">in</span><span class="o">=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span> <span class="nv">out</span><span class="o">=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_interp <span class="nv">method</span><span class="o">=</span>bicubic --o
     r.out.gdal <span class="k">in</span><span class="o">=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_interp <span class="nv">out</span><span class="o">=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_interp.tif --o
 <span class="k">done</span>
</pre></div>
</td></tr></table></div>
<p><strong>Some usful GRASS GIS documentation and links:</strong></p>
<ul class="simple">
<li><a class="reference external" href="https://grass.osgeo.org/grass78/manuals/index.html/">Module documentation</a></li>
<li><a class="reference external" href="https://grasswiki.osgeo.org/wiki/GRASS-Wiki/">GRASS GIS Wiki</a></li>
<li><a class="reference external" href="https://ncsu-osgeorel.github.io/grass-intro-workshop/">GRASS intro workshop held at NCSU</a></li>
<li><a class="reference external" href="https://training.gismentors.eu/grass-gis-workshop-jena-2018/index.html/">GRASS GIS course in Jena 2018</a></li>
<li><a class="reference external" href="https://training.gismentors.eu/grass-gis-irsae-winter-course-2018/index.html">GRASS GIS course IRSAE 2018</a></li>
<li><a class="reference external" href="https://training.gismentors.eu/grass-gis-irsae-winter-course-2018/index.html">GRASS GIS course in Argentina 2018</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="run.html" class="btn btn-neutral float-right" title="PySEBAL data preparation and execution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="install_Lin_Win.html" class="btn btn-neutral float-left" title="Linux in Windows 10" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Sajid Pareeth © 2020 IHE Delft Institute for Water Education.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>